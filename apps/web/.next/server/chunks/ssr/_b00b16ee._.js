module.exports=[88347,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={ACTION_HMR_REFRESH:function(){return k},ACTION_NAVIGATE:function(){return h},ACTION_REFRESH:function(){return g},ACTION_RESTORE:function(){return i},ACTION_SERVER_ACTION:function(){return l},ACTION_SERVER_PATCH:function(){return j},PrefetchKind:function(){return m}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g="refresh",h="navigate",i="restore",j="server-patch",k="hmr-refresh",l="server-action";var m=((d={}).AUTO="auto",d.FULL="full",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},67009,(a,b,c)=>{"use strict";function d(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isThenable",{enumerable:!0,get:function(){return d}})},90841,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={dispatchAppRouterAction:function(){return i},useActionQueue:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(46058)._(a.r(72131)),g=a.r(67009),h=null;function i(a){if(null===h)throw Object.defineProperty(Error("Internal Next.js error: Router action dispatched before initialization."),"__NEXT_ERROR_CODE",{value:"E668",enumerable:!1,configurable:!0});h(a)}function j(a){let[b,c]=f.default.useState(a.state);h=b=>a.dispatch(b,c);let d=(0,f.useMemo)(()=>b,[b]);return(0,g.isThenable)(d)?(0,f.use)(d):d}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},20611,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"callServer",{enumerable:!0,get:function(){return g}});let d=a.r(72131),e=a.r(88347),f=a.r(90841);async function g(a,b){return new Promise((c,g)=>{(0,d.startTransition)(()=>{(0,f.dispatchAppRouterAction)({type:e.ACTION_SERVER_ACTION,actionId:a,actionArgs:b,resolve:c,reject:g})})})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},1722,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"findSourceMapURL",{enumerable:!0,get:function(){return d}});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},1309,a=>{"use strict";var b=a.i(5050);let c=(0,b.createServerReference)("0010576cbce51f2e5055c1e199f288c20d55c5cfcf",b.callServer,void 0,b.findSourceMapURL,"checkIsAdmin");a.s(["checkIsAdmin",()=>c])},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},74684,a=>{"use strict";var b=a.i(42871);function c(a){return{onFetch:(c,f)=>{let g=c.options,h=c.fetchOptions?.meta?.fetchMore?.direction,i=c.state.data?.pages||[],j=c.state.data?.pageParams||[],k={pages:[],pageParams:[]},l=0,m=async()=>{let f=!1,m=(0,b.ensureQueryFn)(c.options,c.fetchOptions),n=async(a,d,e)=>{let g;if(f)return Promise.reject();if(null==d&&a.pages.length)return Promise.resolve(a);let h=(g={client:c.client,queryKey:c.queryKey,pageParam:d,direction:e?"backward":"forward",meta:c.options.meta},(0,b.addConsumeAwareSignal)(g,()=>c.signal,()=>f=!0),g),i=await m(h),{maxPages:j}=c.options,k=e?b.addToStart:b.addToEnd;return{pages:k(a.pages,i,j),pageParams:k(a.pageParams,d,j)}};if(h&&i.length){let a="backward"===h,b={pages:i,pageParams:j},c=(a?e:d)(g,b);k=await n(b,c,a)}else{let b=a??i.length;do{let a=0===l?j[0]??g.initialPageParam:d(g,k);if(l>0&&null==a)break;k=await n(k,a),l++}while(l<b)}return k};c.options.persister?c.fetchFn=()=>c.options.persister?.(m,{client:c.client,queryKey:c.queryKey,meta:c.options.meta,signal:c.signal},f):c.fetchFn=m}}}function d(a,{pages:b,pageParams:c}){let d=b.length-1;return b.length>0?a.getNextPageParam(b[d],b,c[d],c):void 0}function e(a,{pages:b,pageParams:c}){return b.length>0?a.getPreviousPageParam?.(b[0],b,c[0],c):void 0}function f(a,b){return!!b&&null!=d(a,b)}function g(a,b){return!!b&&!!a.getPreviousPageParam&&null!=e(a,b)}a.s(["hasNextPage",()=>f,"hasPreviousPage",()=>g,"infiniteQueryBehavior",()=>c])},38912,57788,94203,90754,3804,2088,942,41101,83974,a=>{"use strict";var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(41579),f=a.i(74684),g=class extends e.QueryObserver{constructor(a,b){super(a,b)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(a){super.setOptions({...a,behavior:(0,f.infiniteQueryBehavior)()})}getOptimisticResult(a){return a.behavior=(0,f.infiniteQueryBehavior)(),super.getOptimisticResult(a)}fetchNextPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"backward"}}})}createResult(a,b){let{state:c}=a,d=super.createResult(a,b),{isFetching:e,isRefetching:g,isError:h,isRefetchError:i}=d,j=c.fetchMeta?.fetchMore?.direction,k=h&&"forward"===j,l=e&&"forward"===j,m=h&&"backward"===j,n=e&&"backward"===j;return{...d,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,f.hasNextPage)(b,c.data),hasPreviousPage:(0,f.hasPreviousPage)(b,c.data),isFetchNextPageError:k,isFetchingNextPage:l,isFetchPreviousPageError:m,isFetchingPreviousPage:n,isRefetchError:i&&!k&&!m,isRefetching:g&&!l&&!n}}},h=a.i(36339);function i(a,b){return(0,h.useBaseQuery)(a,g,b)}let j="/api/ideas";async function k(a){let b=new URLSearchParams;a?.cursor&&b.set("cursor",a.cursor),a?.limit&&b.set("limit",String(a.limit)),a?.sort&&b.set("sort",a.sort);let c=`${j}?${b.toString()}`,d=await fetch(c);if(!d.ok)throw Error((await d.json()).message||"Failed to fetch ideas");return d.json()}async function l(a){let b=await fetch(`${j}/${a}`);if(!b.ok)throw Error((await b.json()).message||"Failed to fetch idea");return b.json()}async function m(a){let b=await fetch(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).message||"Failed to create idea");return b.json()}async function n(a,b){let c=await fetch(`${j}/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).message||"Failed to update idea");return c.json()}async function o(a){let b=await fetch(`${j}/${a}`,{method:"DELETE"});if(!b.ok)throw Error((await b.json()).message||"Failed to delete idea")}a.s(["createIdea",()=>m,"deleteIdea",()=>o,"fetchIdea",()=>l,"fetchIdeas",()=>k,"updateIdea",()=>n],57788);var p=a.i(23292);let q={all:["ideas"],lists:()=>[...q.all,"list"],list:a=>[...q.lists(),a],details:()=>[...q.all,"detail"],detail:a=>[...q.details(),a]};function r(a){return i({queryKey:q.list({sort:a?.sort}),queryFn:({pageParam:b})=>k({cursor:b,limit:a?.limit??20,sort:a?.sort}),getNextPageParam:a=>a.hasMore?a.nextCursor:void 0,initialPageParam:void 0,staleTime:3e4})}function s(a){return(0,b.useQuery)({queryKey:q.detail(a),queryFn:()=>l(a),staleTime:3e4,enabled:!!a&&"undefined"!==a})}function t(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>m(a),onSuccess:()=>{a.invalidateQueries({queryKey:q.lists()}),p.toast.success("Idea created!")},onError:a=>{a.message?.includes("Unauthorized")||a.message?.includes("401")?p.toast.error("Please sign in to create ideas"):p.toast.error(a.message||"Failed to create idea")}})}function u(a){let b=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:b=>n(a,b),onSuccess:()=>{b.invalidateQueries({queryKey:q.detail(a)}),b.invalidateQueries({queryKey:q.lists()}),p.toast.success("Idea updated!")},onError:a=>{a.message?.includes("Forbidden")||a.message?.includes("403")?p.toast.error("You don't have permission to edit this idea"):p.toast.error(a.message||"Failed to update idea")}})}function v(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>o(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:q.detail(c)}),a.invalidateQueries({queryKey:q.lists()}),p.toast.success("Idea deleted")},onError:a=>{a.message?.includes("Forbidden")||a.message?.includes("403")?p.toast.error("You don't have permission to delete this idea"):p.toast.error(a.message||"Failed to delete idea")}})}async function w(a,b){let c=await fetch(`/api/ideas/${a}/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).message||"Failed to vote");return c.json()}async function x(a){let b=await fetch(`/api/ideas/${a}/vote`,{method:"DELETE"});if(!b.ok)throw Error((await b.json()).message||"Failed to remove vote");return b.json()}function y(a){let b=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:b=>w(a,{value:b}),onMutate:async c=>{await b.cancelQueries({queryKey:q.detail(a)}),await b.cancelQueries({queryKey:q.lists()});let d=b.getQueryData(q.detail(a));if(d){let e=d.data.user_vote?.value,f=0,g=0;1===e&&-1===c?(f=-1,g=1):-1===e&&1===c?(f=1,g=-1):e||1!==c?e||-1!==c||(g=1):f=1,b.setQueryData(q.detail(a),{data:{...d.data,upvotes_count:d.data.upvotes_count+f,downvotes_count:d.data.downvotes_count+g,user_vote:{value:c}}})}return{previousIdea:d}},onError:(c,d,e)=>{e?.previousIdea&&b.setQueryData(q.detail(a),e.previousIdea),c.message?.includes("Unauthorized")||c.message?.includes("401")?p.toast.error("Please sign in to vote"):p.toast.error(c.message||"Failed to vote")},onSettled:()=>{b.invalidateQueries({queryKey:q.detail(a)}),b.invalidateQueries({queryKey:q.lists()})}})}function z(a){let b=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:()=>x(a),onMutate:async()=>{await b.cancelQueries({queryKey:q.detail(a)});let c=b.getQueryData(q.detail(a));if(c&&c.data.user_vote){let d=c.data.user_vote.value;b.setQueryData(q.detail(a),{data:{...c.data,upvotes_count:c.data.upvotes_count-(1===d),downvotes_count:c.data.downvotes_count-(-1===d),user_vote:null}})}return{previousIdea:c}},onError:(c,d,e)=>{e?.previousIdea&&b.setQueryData(q.detail(a),e.previousIdea),p.toast.error(c.message||"Failed to remove vote")},onSettled:()=>{b.invalidateQueries({queryKey:q.detail(a)}),b.invalidateQueries({queryKey:q.lists()})}})}async function A(a,b){let c=new URLSearchParams;b?.cursor&&c.set("cursor",b.cursor),b?.limit&&c.set("limit",String(b.limit));let d=`/api/ideas/${a}/comments?${c.toString()}`,e=await fetch(d);if(!e.ok)throw Error((await e.json()).message||"Failed to fetch comments");return e.json()}async function B(a,b){let c=await fetch(`/api/ideas/${a}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).message||"Failed to create comment");return c.json()}a.s(["ideaKeys",0,q,"useCreateIdea",()=>t,"useDeleteIdea",()=>v,"useIdea",()=>s,"useIdeas",()=>r,"useUpdateIdea",()=>u],94203),a.s(["castVote",()=>w,"removeVote",()=>x],90754),a.s(["useRemoveVote",()=>z,"useVote",()=>y],3804),a.s(["createComment",()=>B,"fetchComments",()=>A],2088);let C={all:["comments"],lists:()=>[...C.all,"list"],list:a=>[...C.lists(),a]};function D(a,b){return i({queryKey:C.list(a),queryFn:({pageParam:c})=>A(a,{cursor:c,limit:b?.limit??20}),getNextPageParam:a=>a.hasMore?a.nextCursor:void 0,initialPageParam:void 0,staleTime:3e4,enabled:!!a&&"undefined"!==a})}function E(a){let b=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:b=>B(a,b),onSuccess:()=>{b.invalidateQueries({queryKey:C.list(a)}),b.invalidateQueries({queryKey:q.detail(a)}),b.invalidateQueries({queryKey:q.lists()})},onError:a=>{a.message?.includes("Unauthorized")||a.message?.includes("401")?p.toast.error("Please sign in to comment"):p.toast.error(a.message||"Failed to add comment")}})}async function F(a,b){let c=await fetch(`/api/ideas/${a}/pivot`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).message||"Failed to create pivot");return c.json()}async function G(a){let b=await fetch(`/api/ideas/${a}/history`);if(!b.ok)throw Error((await b.json()).message||"Failed to fetch version history");return b.json()}a.s(["useComments",()=>D,"useCreateComment",()=>E],942),a.i(4171),a.s(["createPivot",()=>F,"fetchVersionHistory",()=>G],41101);let H=a=>[...q.detail(a),"history"];function I(a){return(0,b.useQuery)({queryKey:H(a),queryFn:()=>G(a),enabled:!!a})}function J(a){let b=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:b=>F(a,b),onSuccess:()=>{b.invalidateQueries({queryKey:q.detail(a)}),b.invalidateQueries({queryKey:H(a)}),b.invalidateQueries({queryKey:q.all}),p.toast.success("Pivot created successfully!")},onError:a=>{p.toast.error(a.message||"Failed to create pivot")}})}a.s(["useCreatePivot",()=>J,"useVersionHistory",()=>I],83974),a.i(23273),a.s([],38912)}];

//# sourceMappingURL=_b00b16ee._.js.map